<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Document</title>
</head>
<body>
    <script href="webgazer.js" type="text/javascript" ></script>
    <script type="module">
        import * as THREE from '/three/build/three.module.js';
        import { GLTFLoader } from '/three/examples/jsm/loaders/GLTFLoader.js';
        import { FBXLoader } from '/three/examples/jsm/loaders/FBXLoader.js';

        import { OrbitControls } from '/three/examples/jsm/controls/OrbitControls.js';
        
    

        let scene, camera, controls, renderer, loader, root, light, eyes;
        let x, y;

        function init(){
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0xdddddd);
            camera = new THREE.PerspectiveCamera(40, window.innerWidth/window.innerHeight, 0.1, 2000);
           

            // loader = new GLTFLoader();
            // loader.load('male/scene.gltf', function(gltf){
            //     console.log(gltf);
            
            //     root = gltf.scene.children[0];
            //     root.scale.set(5, 5, 5);
            //     scene.add(gltf.scene);
            //     renderer.render(scene, camera);

            // }, function(xhr){
            //     console.log((xhr.loaded/xhr.total * 100) + "% loader")
            // }, function(error){
            //     console.log('An error occurred')
            // });
            
            
            loader = new GLTFLoader();
            loader.load('male/scene.gltf', function(gltf){
                console.log(gltf);
            
                root = gltf.scene.children[0];
                root.scale.set(5, 5, 5);
                root.position.set(0,-2.4,0);
                scene.add(gltf.scene);
                renderer.render(scene, camera);

            }, function(xhr){
                console.log((xhr.loaded/xhr.total * 100) + "% loader")
            }, function(error){
                console.log('An error occurred')
            });


            
            loader.load('eyes/scene.gltf', function(gltf){
                console.log(gltf);
            
                eyes = gltf.scene.children[0];
                eyes.scale.set(0.01, 0.01, 0.01);
                eyes.position.set(-0.47 , 0.63, -0.93);
                scene.add(gltf.scene);
                renderer.render(scene, camera);

            }, function(xhr){
                console.log((xhr.loaded/xhr.total * 100) + "% loader")
            }, function(error){
                console.log('An error occurred')
            });

            // loader = new FBXLoader();
            // loader.load('female/source/Angelica.fbx', function(fbx){
            //     console.log(fbx);
            //     root = fbx.scene.children[0];
            //     root.scale.set(5, 5, 5);
            //     scene.add(fbx.scene);
            //     renderer.render(scene, camera);

            // }, function(xhr){
            //     console.log((xhr.loaded/xhr.total * 100) + "% loader")
            // }, function(error){
            //     console.log('An error occurred')
            // });


            light = new THREE.DirectionalLight(0xffffff, 1);
            light.position.set(2,2,5);
            scene.add(light);

            document.onmousemove = function(event){
             x = event.x;   
             y = event.y;
            console.log(`${x} + ${y}`);
            }


            renderer = new THREE.WebGLRenderer({antialias:true});
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.gammaOuput = true;
            renderer.render(scene, camera);
            

            controls = new OrbitControls( camera, renderer.domElement );
            camera.position.set(0, 0, 5);
            camera.lookAt(0,0,0);
            controls.update();
            
            document.body.appendChild(renderer.domElement);

            function animate(){
                window.requestAnimationFrame(animate);
                controls.update();
                renderer.render(scene, camera);
                
                eyes.rotation.x = x * 0.01;
                eyes.rotation.z = y * 0.01 - 50;
            }

            animate()
            
        }

        init();

    </script>
</body>
</html>